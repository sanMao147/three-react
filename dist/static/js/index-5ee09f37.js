var e=Object.defineProperty,t=(t,i,n)=>(((t,i,n)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n})(t,"symbol"!=typeof i?i+"":i,n),n);import{a as i}from"./index-c24a0b49.js";import{_ as n,G as a,V as s,$ as o,a0 as r,a1 as d,S as c,P as h,W as l,a2 as u,a3 as m,r as w,D as p,O as g,h as f}from"./three-925ba127.js";import{r as y}from"./react-aa034a1c.js";import"./react-dom-67b4aaa0.js";import"./classnames-46b2866a.js";import"./scheduler-6fdbf8de.js";import"./react-router-dom-824b8f8a.js";import"./react-router-ca90130e.js";import"./@remix-run-f8738e57.js";const S=()=>{let e=y.useRef(null);y.useEffect((()=>{S()}),[]);const S=()=>{const i={width:window.innerWidth,height:window.innerHeight},y=new c,S=new h(45,i.width/i.height,1,1e4);S.position.set(1200,700,121),y.add(S);const x=new l({canvas:e.current,antialias:!0,alpha:!0});x.setPixelRatio(Math.min(window.devicePixelRatio,2)),x.setSize(i.width,i.height),x.setClearColor(new u("#32373E"),1);const v=new m(800);y.add(v);const b=new w(11382189);y.add(b);const j=new p(16777215,.5);j.position.set(100,100,0),y.add(j);const L=new g(S,e.current);L.target.set(0,0,0),L.enableDamping=!0,window.addEventListener("resize",(()=>{S.aspect=window.innerWidth/window.innerHeight,S.updateProjectionMatrix(),x.setSize(window.innerWidth,window.innerHeight)}),!1);const B=new class{constructor(){t(this,"animate",(e=>{if(e>1)return!1;this.time.value+=e,this.isStart&&(this.StartTime.value+=.5*e,this.StartTime.value>=1&&(this.StartTime.value=1,this.isStart=!1))})),this.fbxLoader=new n,this.group=new a,this.effectGroup=new a,this.group.add(this.effectGroup),this.time={value:0},this.StartTime={value:0},this.isStart=!1;const e=["CITY_UNTRIANGULATED"],i=["LANDMASS"];this.loadFbx("/three-react/static/FBX/shanghai-68103d2f.FBX").then((t=>{this.group.add(t),t.traverse((t=>{e.includes(t.name)&&(this.setCityMaterial(t),this.setRoundLine(t)),i.includes(t.name)&&this.setFloor(t)}))}))}loadFbx(e){return new Promise(((t,i)=>{try{this.fbxLoader.load(e,(e=>{t(e)}))}catch(n){i(n)}}))}setCityMaterial(e){e.geometry.computeBoundingBox(),e.geometry.computeBoundingSphere();const{geometry:t,material:i}=e;t.boundingSphere;const{max:n,min:a}=t.boundingBox;new s(n.x-a.x,n.y-a.y,n.z-a.z),i.transparent=!0,i.color.setStyle("#1B3045")}setFloor(e){e.material.color.setStyle("#32373E")}setRoundLine(e){const t=new o(e.geometry),i=new s;e.getWorldPosition(i);const n=new r({color:5016565,linewidth:1,linecap:"round",linejoin:"round"}),a=new d(t,n);a.name="surroundLine",a.scale.copy(e.scale),a.rotation.copy(e.rotation),a.position.copy(i),this.effectGroup.add(a)}}({});y.add(B.group);const F=new f,P=()=>{const e=F.getDelta();B.animate(e),L.update(),x.render(y,S),requestAnimationFrame(P)};P()};return i("div",{className:"citypage",children:i("canvas",{ref:e})})};export{S as default};
