import{j as e,a as t}from"./index-c24a0b49.js";import{a as n}from"./axios-1aa4d7e2.js";import{r as s}from"./react-aa034a1c.js";import{S as a,P as o,W as i,A as r,z as c,E as d,V as p,F as h,H as l,I as w,a as m,i as g,O as u,u as f,J as S,G as j,K as x,Q as z,U as v,X as b,Y as y,r as E,D as P,Z as A,s as M}from"./three-925ba127.js";import{m as C}from"./d3-geo-80b69124.js";import"./react-dom-67b4aaa0.js";import"./classnames-46b2866a.js";import"./scheduler-6fdbf8de.js";import"./react-router-dom-824b8f8a.js";import"./react-router-ca90130e.js";import"./@remix-run-f8738e57.js";import"./d3-array-7cca7373.js";const F=["/three-react/static/png/px-e265bd50.png","/three-react/static/png/nx-e325fe63.png","/three-react/static/png/py-75336e88.png","/three-react/static/png/ny-8fc1866b.png","/three-react/static/png/pz-229278d4.png","/three-react/static/png/nz-d4675e3b.png"];n.defaults.timeout=6e4,n.interceptors.request.use((e=>(e.headers={"Content-Type":"application/json;charset=UTF-8"},e)),(e=>Promise.reject(e))),n.interceptors.response.use((e=>e),(e=>{const{response:t}=e;if(t)return Promise.reject(t.data)}));const T=()=>{const T=C().center([104,37.5]).scale(80).translate([0,0]),[W,H]=s.useState(""),[D,O]=s.useState({left:"",top:""});let J=s.useRef(null),R=null,X=null,Y=null;s.useEffect((()=>{$()}),[]);const $=async()=>{const e=await function(){return e={url:"/three-react/json/china.json",method:"get"},new Promise(((t,s)=>{n(e).then((e=>{t(e.data)})).catch((e=>{s(e)}))}));var e}(),t=JSON.parse(JSON.stringify(e)),s={width:window.innerWidth,height:window.innerHeight};X=new a;const j=new o(75,s.width/s.height,1,5e3);j.position.set(0,-60,70),j.lookAt(0,0,0),X.add(j);const x=new i({canvas:J.current,antialias:!0});x.setPixelRatio(Math.min(window.devicePixelRatio,2)),x.setSize(s.width,s.height),x.toneMapping=r,x.shadowMap.enabled=!0,x.toneMappingExposure=1.25,x.outputEncoding=c,x.setClearColor(16777215,0);const z=new d({maxFar:1e3,cascades:4,mode:"practical",parent:X,shadowMapSize:1024,lightDirection:new p(-1,-1,-1).normalize(),camera:j}),v=new h(z);v.visible=!1,X.add(v);const b=new l({color:202807,metalness:0,roughness:1,opacity:.5,transparent:!0});R=new w,X.add(R);const y=new m(new g(2e3,2e3,1,1),b);y.position.z=0,y.receiveShadow=!0,X.add(y);const E=new u(j,J.current);E.target.set(0,0,0),E.enableDamping=!0,E.enablePan=!1,E.minPolarAngle=1,E.maxPolarAngle=1.6,E.minAzimuthAngle=-.2,E.maxAzimuthAngle=.2,E.maxDistance=250,k(t),q(),window.addEventListener("resize",(()=>{j.aspect=window.innerWidth/window.innerHeight,j.updateProjectionMatrix(),x.setSize(window.innerWidth,window.innerHeight)}),!1);const P=new f;let A=new S;window.addEventListener("mousemove",(e=>{A.x=e.clientX/window.innerWidth*2-1,A.y=-e.clientY/window.innerHeight*2+1,O({left:e.clientX+10+"px",top:e.clientY-20+"px"})}),!1);const M=()=>{if(E.update(),j.updateMatrixWorld(),z.update(),P&&Y.children.length>0){P.setFromCamera(A,j);const e=P.intersectObjects(Y.children);if(1===e.length){const t=e[0].object.parent.properties;H(t.name)}else H("")}x.render(X,j),requestAnimationFrame(M)};M()},k=e=>{Y=new j,(new x).load(F,(t=>{R.copy(z.fromCubeTexture(t)),e.features.forEach(((e,t)=>{const n=new v,{coordinates:s}=e.geometry,a=16777215*Math.random();if(s.forEach((e=>{e.forEach((e=>{const s=new b;for(let t=0;t<e.length;t++){let[n,a]=T(e[t]);0===t&&s.moveTo(n,-a),s.lineTo(n,-a)}const o=new y(s,{depth:4,bevelEnabled:!0,bevelSegments:1,bevelThickness:.2}),i=new l({color:a,metalness:1}),r=new l({color:a,metalness:1,roughness:1}),c=new m(o,[i,r]);t%2==0&&c.scale.set(1,1,1.2),c.castShadow=!0,c.receiveShadow=!0,c._color=a,n.add(c)}))})),n.properties=e.properties,e.properties.centroid){const[t,s]=T(e.properties.centroid);n.properties._centroid=[t,s]}Y.add(n)})),X.environment=t,t.dispose(),X.add(Y)}))},q=()=>{const e=new j;let t=new E(16777215,.2);const n=new P(16777215,.5);n.position.set(20,-50,20),n.castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024;let s=new A("#80edff","#75baff",.3);s.position.set(20,-50,0);const a=new M(16777215,.5);a.position.set(20,-50,50),a.castShadow=!0,a.shadow.mapSize.width=1024,a.shadow.mapSize.height=1024;const o=new M(16777215,.5);o.position.set(50,-50,20),o.castShadow=!0,o.shadow.mapSize.width=1024,o.shadow.mapSize.height=1024;const i=new M(16777215,.5);i.position.set(-50,-50,20),i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,e.add(t,i,n,a,o,s),X.add(e)},G={position:"absolute",top:`${D.top}`,left:`${D.left}`,color:"#050315",userSelect:"none"};return e("div",{style:{position:"relative"},children:[t("div",{style:G,children:W}),t("canvas",{ref:J})]})};export{T as default};
