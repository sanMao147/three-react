import{j as e,a as t}from"./index-75bee22b.js";import{T as a,O as n,W as i,S as o,G as s,L as r,a as l}from"./three-494876a0.js";import{Clock as c,Scene as d,PerspectiveCamera as m,WebGLRenderer as p,ACESFilmicToneMapping as h,PlaneGeometry as w,TextureLoader as u,RepeatWrapping as v,Vector3 as g,PMREMGenerator as x,MathUtils as y,ShaderMaterial as b,DoubleSide as f,TorusGeometry as z,Mesh as S,LoadingManager as N,AnimationMixer as M,AmbientLight as L,DirectionalLight as j,PointLight as P,Raycaster as E}from"three";import"./react-a184441f.js";import"./react-dom-714ddeef.js";import"./react-router-dom-c5c4ad88.js";import"./react-router-0527009b.js";import"./@remix-run-7a90bf55.js";const R=(e,t,n,i,o=2e3,s)=>{var r=new a.Tween({x1:e.position.x,y1:e.position.y,z1:e.position.z,x2:t.target.x,y2:t.target.y,z2:t.target.z});r.to({x1:n.x,y1:n.y,z1:n.z,x2:i.x,y2:i.y,z2:i.z},o),r.onUpdate((function(a){e.position.x=a.x1,e.position.y=a.y1,e.position.z=a.z1,t.target.x=a.x2,t.target.y=a.y2,t.target.z=a.z2,t.update()})),r.onComplete((function(){t.enabled=!0,s()})),r.easing(a.Easing.Cubic.InOut),r.start()},D=()=>{const[D,C]=React.useState([]),[T,A]=React.useState(!1);let q=React.useRef(null);React.useEffect((()=>{W()}),[]);const W=()=>{const e=new c,t={width:window.innerWidth,height:window.innerHeight},T=new d,W=new m(55,t.width/t.height,1,2e4);W.position.set(0,600,1600),T.add(W);const G=new p({canvas:q.current,antialias:!0});G.setPixelRatio(Math.min(window.devicePixelRatio,2)),G.setSize(t.width,t.height),G.toneMapping=h;const H=new n(W,q.current);H.target.set(0,0,0),H.enableDamping=!0,H.enablePan=!1,H.maxPolarAngle=1.5,H.minDistance=50,H.maxDistance=1200;const U=new w(1e4,1e4),V=new i(U,{textureWidth:512,textureHeight:512,waterNormals:(new u).load("/three-react/static/jpg/waterNormals-add9912b.jpg",(e=>{e.wrapS=e.wrapT=v})),sunDirection:new g,sunColor:16777215,waterColor:29439,distortionScale:4,fog:void 0!==T.fog});V.rotation.x=-Math.PI/2,T.add(V),V.rotation.x=-Math.PI/2,T.add(V);const k=new o;k.scale.setScalar(1e4),T.add(k);const F=k.material.uniforms;F.turbidity.value=20,F.rayleigh.value=2,F.mieCoefficient.value=.005,F.mieDirectionalG.value=.8;const I=new g,O=new x(G),_=y.degToRad(88),X=y.degToRad(180);I.setFromSphericalCoords(1,_,X),k.material.uniforms.sunPosition.value.copy(I),V.material.uniforms.sunDirection.value.copy(I).normalize(),T.environment=O.fromScene(k).texture;const Y=new b({side:f,transparent:!0,uniforms:{},vertexShader:"\nvarying vec2 vUV;\nvarying vec3 vNormal;\n\nvoid main () {\n  vUV = uv;\n  vNormal = vec3(normal);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"varying vec2 vUV;\nvarying vec3 vNormal;\n\nvoid main () {\n  vec4 c = vec4(abs(vNormal) + vec3(vUV, 0.0), 0.1);\n  gl_FragColor = c;\n}"}),$=new z(200,10,50,100),Z=new S($,Y);Z.opacity=.1,Z.position.set(0,-50,-400),T.add(Z);const B=new N;B.onProgress=async(e,t,a)=>{100===Math.floor(t/a*100)&&R(W,H,{x:0,y:40,z:140},{x:0,y:0,z:0},4e3,(()=>{A(!0)}))};const J=new s(B);J.load("/three-react/static/glb/island-1ac7a40d.glb",(e=>{e.scene.traverse((e=>{e.isMesh&&(e.material.metalness=.4,e.material.roughness=.6)})),e.scene.position.set(0,-2,0),e.scene.scale.set(33,33,33),T.add(e.scene)})),J.load("/three-react/static/glb/flamingo-9eabeb58.glb",(e=>{const t=e.scene.children[0];t.scale.set(.35,.35,.35),t.position.set(-100,80,-300),t.rotation.y=-1,t.castShadow=!0,T.add(t);const a=t.clone();a.position.set(150,80,-500),T.add(a);const n=new M(t);n.clipAction(e.animations[0]).setDuration(1.2).play(),C([...D,n]);const i=new M(a);i.clipAction(e.animations[0]).setDuration(1.8).play(),C([...D,i])}));const K=new L(16777215,.8);T.add(K);const Q=new j(16777215,1);Q.color.setHSL(.1,1,.95),Q.position.set(-1,1.75,1),Q.position.multiplyScalar(30),T.add(Q);const ee=new P(16777215,1.2,2e3);ee.color.setHSL(.995,.5,.9),ee.position.set(0,45,-2e3);const te=new u,ae=te.load("/three-react/static/png/lensflare0-cc6aae5d.png"),ne=te.load("/three-react/static/png/lensflare1-b777765d.png"),ie=new r;ie.addElement(new l(ae,600,0,ee.color)),ie.addElement(new l(ne,60,.6)),ie.addElement(new l(ne,70,.7)),ie.addElement(new l(ne,120,.9)),ie.addElement(new l(ne,70,1)),ee.add(ie),T.add(ee);const oe=new E,se=[{position:new g(10,46,0),element:document.querySelector(".point-0")},{position:new g(-10,8,24),element:document.querySelector(".point-1")},{position:new g(30,10,70),element:document.querySelector(".point-2")},{position:new g(-100,50,-300),element:document.querySelector(".point-3")},{position:new g(-120,50,-100),element:document.querySelector(".point-4")}];document.querySelectorAll(".point").forEach((e=>{e.addEventListener("click",(e=>{switch(e.target.classList[e.target.classList.length-1]){case"label-0":R(W,H,{x:-15,y:80,z:60},{x:0,y:0,z:0},1600,(()=>{}));break;case"label-1":R(W,H,{x:-20,y:10,z:60},{x:0,y:0,z:0},1600,(()=>{}));break;case"label-2":R(W,H,{x:30,y:10,z:100},{x:0,y:0,z:0},1600,(()=>{}));break;default:R(W,H,{x:0,y:40,z:140},{x:0,y:0,z:0},1600,(()=>{}))}}),!1)})),window.addEventListener("resize",(()=>{W.aspect=window.innerWidth/window.innerHeight,W.updateProjectionMatrix(),G.setSize(window.innerWidth,window.innerHeight)}),!1);const re=()=>{V.material.uniforms.time.value+=1/60,H&&H.update();const n=e.getDelta();D&&D.forEach((e=>{e.update(n)}));const i=5e-4*Date.now();a&&a.update(),W&&(W.position.y+=.05*Math.sin(i));for(const e of se){const a=e.position.clone();a.project(W),oe.setFromCamera(a,W);const n=oe.intersectObjects(T.children,!0);0===n.length?e.element.classList.add("visible"):n[0].distance<e.position.distanceTo(W.position)?e.element.classList.remove("visible"):e.element.classList.add("visible");const i=a.x*t.width*.5,o=-a.y*t.height*.5;e.element.style.transform=`translateX(${i}px) translateY(${o}px)`}G.render(T,W),requestAnimationFrame(re)};re()};return e("div",{className:"ocean",children:[t("canvas",{ref:q}),e("div",{className:"point point-0",children:[t("div",{className:"label label-0",children:"1"}),t("div",{className:"text",children:"灯塔"})]}),e("div",{className:"point point-1",children:[t("div",{className:"label label-1",children:"2"}),t("div",{className:"text",children:"小船"})]}),e("div",{className:"point point-2",children:[t("div",{className:"label label-2",children:"3"}),t("div",{className:"text",children:"沙滩"})]}),e("div",{className:"point point-3",children:[t("div",{className:"label label-3",children:"4"}),t("div",{className:"text",children:"飞鸟"})]}),e("div",{className:"point point-4",children:[t("div",{className:"label label-4",children:"5"}),t("div",{className:"text",children:"礁石"})]})]})};export{D as default};
